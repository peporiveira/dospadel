<html lang="en">
<head>
  <title></title>
  <link type="text/css" rel="stylesheet" href="/stylesheets/style1.css" />
  <script type="text/javascript" src="/src/prototype.js"></script>
  <script>
    function test(){
      //alert("Prototype "+Prototype.Version);
      var form = $('form_new_reserve');
      var data = form.serialize()
 
      new Ajax.Request(
        '/check',
        {
          method: 'POST',
          parameters: data,
          onComplete: showResponse
        });
    }
    function showResponse(original_request){
      //alert(original_request.responseText);
      var response = parseInt(original_request.responseText,10);
      if (response == 0)
        alert("way! puedes reservar");
      else
        alert("esta ocupado :(");

    }
    
  </script>
</head>

<body>
<div>
<div id='product_nm'>{{ product.nm }}</div>
<p id='product_desc'>{{ product.desc }}</p>
<p><img src='{{product.nm}}/img'/></p>
</div>

{% if user %}
<form method='POST' action={{ product.nm }} id='form_new_reserve'>
  <input type="date" name="date"/>
  <input type="hidden" name="name" value="{{product.nm}}"/>
  <select name="time">
    {% for element in journey %}
    <option value={{ element.hour }}:00:00>{{ element.hour }}:00</option>
    {% endfor %}
  </select>

  <input type="submit" value="reserve"/>
<form>
<input id="check" type="button" value="check"/>

<script>
  $('check').observe('click',test);
</script>

{% endif %}


</body>
</html>
